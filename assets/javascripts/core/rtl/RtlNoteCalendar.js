if("undefined"==typeof jQuery)throw new Error("rtl note calendar controller request jQuery 1.9.1+");+function(e,t,n){"use strict";function o(e,t,n){var o=new Date(t.setTime),l=new Date(o.getFullYear(),"pre"===n?o.getMonth():o.getMonth()+2,0).getDate(),r=new Date(o.getFullYear(),"pre"===n?o.getMonth()-1:o.getMonth()+1,0).getDate(),i=new Date(o.getFullYear(),"pre"===n?o.getMonth()-1:o.getMonth()+1,1);t.setTime=i.getFullYear()+"/"+(i.getMonth()+1)+"/1";var a=i.getDay()-1;a===-1&&(a=6);var d=i.getFullYear()+"/"+(i.getMonth()+1)+"/1";if(a>0){var s=new Date(o.getFullYear(),"pre"===n?o.getMonth()-2:o.getMonth(),r-a+1);d=s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()}var c=new Date(o.getFullYear(),"pre"===n?o.getMonth()-1:o.getMonth()+1,l),p=c.getDay()-1;p==-1&&(p=6);var u=c.getFullYear()+"/"+(c.getMonth()+1)+"/"+l;if(p<6){var s=new Date(o.getFullYear(),"pre"===n?o.getMonth():o.getMonth()+2,6-p);u=s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()}t.callback("button",d,u,function(n){t.data=n,t.cellBox.innerHTML="",e._createCell(t,t.bodyNode)})}var l=function(e){var t=this;if("undefined"==typeof e&&"Function"!==e.constructor)throw new Error("rtl note calendar’s options parameter is a must and must be an object");if("undefined"==typeof e.elId)throw new Error("rtl note calendar’s elId parameter is a must");var n=e.date,o=new RegExp("^([0-9]{4}-[0-9]{1,2}-[0-9]{1,2} ?[0-9:]*)|([0-9]{4}/[0-9]{1,2}/[0-9]{1,2} ?[0-9:]*)$");n="undefined"!=typeof n&&""!==n&&o.test(n)?n.replace(/\-/g,"/"):"",this.options={elId:e.elId,data:e.data,mainNode:null,container:null,bodyNode:null,cellBox:null,preBtn:null,titleNode:null,nextBtn:null,cls:t._styles(),counter:0,setTime:n,type:e.type||"",callback:e.callback,isInitial:!0},t._nodeReady(function(){t._init()})};l.prototype={_nodeReady:function(e){var t=this,o=t.options;setTimeout(function(){var l=null;if(l=0===o.elId.indexOf(".")?n(o.elId)[0]:document.getElementById(o.elId))o.mainNode=l,o.counter=0,e();else if(t._nodeReady(),o.counter++,o.counter>30)throw o.counter=0,new Error(o.elId+"’s element not exist")},50)},_styles:function(){var e={};return e.titleBox=";display: block; position: relative; height: 50px; line-height: 50px; border: solid 1px #e6eaee;",e.titleBtn=";position: absolute; display: block; width: 60px; height: 28px; line-height: 28px; right: 15px; top: 10px; background-color: #48a7f2; border: 1px solid #48a7f2; border-radius: 4px; text-align: center; font-size: 14px; color: #fff;",e.showBox=";display: block; position: relative; width: 214px; height: 50px; line-height: 50px; margin: 0 auto;",e.titleDesc=";display: block; position: relative; height: 48px; line-height: 48px; z-index: 1; font-size: 14px; color: #666; font-weight: 400; text-align: center;",e.preIcon=';display: block; position: absolute; width: 24px; height: 24px; left: 0; top: 12px; border: solid 1px #fff; border-radius: 4px; background-color: transparent; z-index: 6; cursor: pointer; background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAWVJREFUOBFjYKAyYCTVPGNjX64vn1+tZvzP8PLG7ZNJ6PqZ0AXw8bW1HXi+fn65neH/f08mJoZ92NQS7UJ1dWtehv9/QIZZMjIwJd+4fWIBNgOJcqGxsQs/478/uxj+M1gwMDHF4TIMZAFBF+rq2gj++vlrJyMDoyEQx1y/dWIlNpfBxPAaqK1tKfT31989QGt1/jMyRt28eXINTCMuGqeXjdUcRP78/rcPaJg20NYwYgwDWYLVhXp6VmK/vv/Z+5+BQZWRmTnkxo3jW3C5CF2cBV0AxP/14+82oFXqLIzMfldvHN+BTQ0uMVxevvX/PwPrP4a/erg04hJnxiYhr+C96fevFzpAQ3PFRKW/v3n79Cg2ddjEsBr4/PnZf0BD15FjKFYDQTaTayhOA8k1FK+B5BhK0EBSDSXKQGyGiojKfHj79ulJkBwywJUOkdXA2WfPzvrNzWsQzsjIuJzxH4MTXIKWDAAjZ7shRzUoaQAAAABJRU5ErkJggg==") center no-repeat;',e.nextIcon=';display: block; position: absolute; width: 24px; height: 24px; right: 0; top: 12px; border: solid 1px #fff; border-radius: 4px; background-color: transparent; z-index: 7; cursor: pointer; background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAURJREFUOBFjYKAHUFcz26OhZj4/NDSUmVT7mLBpYGRg3Pv///+ESxcfLndwcGDBpgaXGFYXvHn79IiIsOxfBob/OV+//NaVV/Be9/z52X+4DEEWx2ogSMHbd08OiYnK/gC6NPf3zxcG4pJWa1+/vga0BD/AaSBI25u3T46Kish+/s/wP/ffv0/GZmZ6a+/cuYPXULwGQg09DvT+e6D38z68+2Gmqi639smTJ39wuZOggSCNQO+fBHr/Fcj737//t1RQMFrz/Pmt39gMJcpAkEag988Avf+M4f//vN8/v9pIyWivfvnyLoahWJMNNptBYjdunZjNwMSY8p+Bwf7Xj4+LsKkjyUCQAYz/GYygBt3CZiBJYsDcM0Vd1ew/iCZJIzbFo4ZhCxX8YlQOM4s+cmMTezr8/8+BkZGp/8atkzn4/UEHWQCLe4+J6Z8rQAAAAABJRU5ErkJggg==") center no-repeat;',e.labelBox=";display: block; position: relative; height: 40px; line-height: 40px; background-color: #f6f8fa;",e.label=";width: 14.285714%; float: left; font-size: 12px; font-weight: 400; color: #666; text-align: center; white-space: nowrap;",e.ulBox=";padding: 0; margin: 0; list-style: none; border-top: 1px solid #d7d7d7; border-right: 1px solid #d7d7d7;",e.liNode=";display: block; position: relative; height: 122px; line-height: 122px; border-bottom: 1px solid #d7d7d7; overflow: hidden; zoom: 1;",e.liChildBox=";width: 14.285714%; float: left; height: 122px;",e.cellBox=";display: block; position: relative; height: 122px; border-left: 1px solid #d7d7d7;",e.cellLabel=";display: block; height: 34px; line-height: 34px; padding-top: 4px; padding-right: 15px; text-align: right; font-size: 16px; color: #222; font-weight: 400;",e.cellBlock=";display: block; position: absolute; width: 100%; left: 0; height: 20px; line-height: 20px; text-align: left; font-weight: 400; text-indent: 11px; border-left: solid 2px #666; background-color: #ccc; color: #666; cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",e.bubbleCellBlock=";display: block; position: absolute; width: 100%; left: 0; height: 32px; line-height: 32px; text-align: left; font-weight: 400; text-indent: 5px; border-left: solid 2px #666; background-color: #ccc; color: #666; cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",e.hasConfirmed=";border-color: #1ac561; background-color: #edf9ee; color: #1ac561;",e.notConfirmed=";border-color: #ffa516; background-color: #fdf4e6; color: #ffa516;",e.arrived=";border-color: #48a7f2; background-color: #e4f6fd; color: #48a7f2;",e.refunds=";border-color: #ff3a04; background-color: #ebeff2; color: #ff3a04;",e.confBubble=";display: block; position: absolute; top: 0; right: 0; height: 16px; line-height: 16px; font-size: 10px; font-weight: 100; background-color: #999; color: #fff; border-top-left-radius: 4px; border-bottom-left-radius: 4px; padding: 0 2px 0 0;",e.confBubbleAct=";background-color: #ff8700; color: #fff;",e.emergencyBubble=";display: block; position: absolute; top: 18px; width: 14px; height: 14px; background-color: #ccc; color: #666; border-radius: 4px; font-size: 12px; line-height: 14px; text-align: left; text-indent: 1px; background-color: #999; color: #fff;",e.emergencyBubbleAct=";background-color: #f00;",e.newBubble=";display: block; position: absolute; top: 18px; right: 0; width: 14px; height: 14px; background-color: #ccc; color: #666; border-radius: 4px; font-size: 12px; line-height: 14px; text-align: left; text-indent: 1px; background-color: #999; color: #fff;",e.newBubbleAct=";background-color: #fecf33;",e},_init:function(){var t=this,n=t.options;n.mainNode.style.position="relative",n.container=e.createElement("div"),n.mainNode.appendChild(n.container),t._createTitle(n),t._createBody(n)},_createTitle:function(t){var n=e.createElement("div");n.setAttribute("style",t.cls.titleBox),t.container.appendChild(n);var o=e.createElement("div");o.setAttribute("style",t.cls.showBox),n.appendChild(o),t.preBtn=e.createElement("span"),t.preBtn.setAttribute("note-previous","previous"),t.preBtn.setAttribute("style",t.cls.preIcon),o.appendChild(t.preBtn),t.titleNode=e.createElement("span"),t.titleNode.setAttribute("style",t.cls.titleDesc),o.appendChild(t.titleNode),t.nextBtn=e.createElement("span"),t.nextBtn.setAttribute("note-next","next"),t.nextBtn.setAttribute("style",t.cls.nextIcon),o.appendChild(t.nextBtn);var l=e.createElement("span");l.setAttribute("style",t.cls.titleBtn),n.appendChild(l),l.innerText="月"},_createBody:function(t){var n=this;t.bodyNode=e.createElement("div"),t.container.appendChild(t.bodyNode),n._createLabel(t,t.bodyNode),n._createCell(t,t.bodyNode)},_createLabel:function(t,n){var o=["周一","周二","周三","周四","周五","周六","周日"],l=e.createElement("div");l.setAttribute("style",t.cls.labelBox),n.appendChild(l);for(var r=0;r<o.length;r++){var i=e.createElement("div");i.setAttribute("style",t.cls.label),i.innerText=o[r],l.appendChild(i)}},_createCell:function(t,n){var o=this,l="";l=""===t.setTime?new Date:new Date(t.setTime),t.setTime=l.getFullYear()+"/"+(l.getMonth()+1)+"/1";var r=new Date(t.setTime);t.titleNode.innerText=r.getFullYear()+"年"+(r.getMonth()+1)+"月";var i=new Date(r.getFullYear(),r.getMonth()+1,0).getDate(),a=new Date(r.getFullYear(),r.getMonth(),0).getDate(),d=new Date(r.getFullYear(),r.getMonth(),1).getDay()-1;d==-1&&(d=6);var s=[],c=Math.ceil((1*i+1*d)/7);if(d>0)for(var p=a-d,u=p;u<a;u++){var f=new Date(r.getFullYear(),r.getMonth()-1,u+1),b=f.getFullYear()+"/"+(f.getMonth()+1)+"/"+f.getDate();s.push({date:b,label:u+1,disable:!0})}for(var g=d;g<7*c;g++){var h=g-d+1;if(h>i){h-=i;var f=new Date(r.getFullYear(),r.getMonth()+1,h),b=f.getFullYear()+"/"+(f.getMonth()+1)+"/"+f.getDate();s.push({date:b,label:h,disable:!0})}else{var f=new Date(r.getFullYear(),r.getMonth(),h),b=f.getFullYear()+"/"+(f.getMonth()+1)+"/"+f.getDate();s.push({date:b,label:h,disable:!1})}}t.cellBox=e.createElement("div"),n.appendChild(t.cellBox);var x=e.createElement("ul");x.setAttribute("style",t.cls.ulBox),t.cellBox.appendChild(x);for(var g=0;g<s.length/7;g++){var v=e.createElement("li");v.setAttribute("style",t.cls.liNode);for(var u=0;u<7;u++){var y=7*g+u,A=e.createElement("div");A.setAttribute("style",t.cls.liChildBox),v.appendChild(A);var m=e.createElement("div");m.setAttribute("style",t.cls.cellBox),A.appendChild(m);var B=e.createElement("span");B.setAttribute("style",t.cls.cellLabel),B.innerText=s[y].label,B.setAttribute("note-date",s[y].date),m.appendChild(B);var w=s[7*g+u].disable;w&&(B.style.color="#ccc");var C=null;if("undefined"!=typeof t.data&&""!==t.data&&t.data.constructor===Array)for(var k=0;k<t.data.length;k++){var M=new Date(t.data[k].date).getTime(),N=new Date(s[y].date).getTime();if(M===N){C=t.data[k].data;break}}null!==C&&("bubble"===t.type?o._createBubbleNoteLabel(t,s,C,w,m,y):o._createNoteLabel(t,s,C,w,m,y))}x.appendChild(v)}t.isInitial&&(t.isInitial=!1,t.callback("init",s[0].date,s[7*c-1].date,function(e){t.data=e,t.cellBox.innerHTML="",o._createCell(t,t.bodyNode)})),o._bindEvent()},_createBubbleNoteLabel:function(t,n,o,l,r,i){var a=0;if("undefined"!=typeof o.refunds&&1*o.refunds!==0){var d=e.createElement("span");d.setAttribute("style",t.cls.bubbleCellBlock+(l?"":t.cls.arrived)),d.setAttribute("note-data","refunds|"+o.refunds+"|"+n[i].date),l?d.style.cursor="default":d.setAttribute("note-event","event"),d.style.bottom=32*a+2+"px",d.innerText="退货单"+o.refunds,r.appendChild(d),++a}if("undefined"!=typeof o.orders&&1*o.orders!==0){var s=e.createElement("span");if(s.setAttribute("style",t.cls.bubbleCellBlock+(l?"":t.cls.hasConfirmed)),s.setAttribute("note-data","orders|"+o.orders+"|"+n[i].date),l?s.style.cursor="default":s.setAttribute("note-event","event"),s.style.bottom=34*a+2+"px",s.innerText="订货单"+o.orders,r.appendChild(s),++a,"undefined"!=typeof o.notConfirmed&&1*o.notConfirmed!==0){var c=e.createElement("span");c.setAttribute("style",t.cls.confBubble+(l?"":t.cls.confBubbleAct)),c.innerText="未确认"+o.notConfirmed,s.appendChild(c)}var p=0;if("undefined"!=typeof o.emergency&&1==o.emergency){var u=e.createElement("span");u.setAttribute("style",t.cls.emergencyBubble+(l?"":t.cls.emergencyBubbleAct)),u.style.right=16*p+"px",u.innerText="急",s.appendChild(u),p++}if("undefined"!=typeof o.newFlag&&1==o.newFlag){var f=e.createElement("span");f.setAttribute("style",t.cls.newBubble+(l?"":t.cls.newBubbleAct)),f.style.right=16*p+"px",f.innerText="新",s.appendChild(f)}}},_createNoteLabel:function(t,n,o,l,r,i){var a=0;if("undefined"!=typeof o.refunds){var d=e.createElement("span");d.setAttribute("style",t.cls.cellBlock+(l?"":t.cls.refunds)),d.setAttribute("note-data","refunds|"+o.refunds+"|"+n[i].date),l?d.style.cursor="default":d.setAttribute("note-event","event"),d.style.bottom=22*a+2+"px",d.innerText="退货单"+o.refunds,r.appendChild(d),++a}if("undefined"!=typeof o.arrived){var s=e.createElement("span");s.setAttribute("style",t.cls.cellBlock+(l?"":t.cls.arrived)),s.setAttribute("note-data","arrived|"+o.arrived+"|"+n[i].date),l?s.style.cursor="default":s.setAttribute("note-event","event"),s.style.bottom=22*a+2+"px",s.innerText="已到货订单"+o.arrived,r.appendChild(s),++a}if("undefined"!=typeof o.notConfirmed){var c=e.createElement("span");c.setAttribute("style",t.cls.cellBlock+(l?"":t.cls.notConfirmed)),c.setAttribute("note-data","notConfirmed|"+o.notConfirmed+"|"+n[i].date),l?c.style.cursor="default":c.setAttribute("note-event","event"),c.style.bottom=22*a+2+"px",c.innerText="未确认订单"+o.notConfirmed,r.appendChild(c),++a}if("undefined"!=typeof o.hasConfirmed){var p=e.createElement("span");p.setAttribute("style",t.cls.cellBlock+(l?"":t.cls.hasConfirmed)),p.setAttribute("note-data","hasConfirmed|"+o.hasConfirmed+"|"+n[i].date),l?p.style.cursor="default":p.setAttribute("note-event","event"),p.style.bottom=22*a+2+"px",p.innerText="已确认订单"+o.hasConfirmed,r.appendChild(p),++a}},_bindEvent:function(){var e=this,t=e.options;n(t.container).on("mouseover",'span[note-previous="previous"], span[note-next="next"]',function(){var e=this;e.style.backgroundColor="#ccc",e.style.borderColor="#ccc"}).on("mouseout",'span[note-previous="previous"],span[note-next="next"]',function(){var e=this;e.style.backgroundColor="transparent",e.style.borderColor="#fff"}),n(t.preBtn).unbind("click").on("click",function(){o(e,t,"pre")}),n(t.nextBtn).unbind("click").on("click",function(){o(e,t,"next")}),n(t.cellBox).unbind("click").on("click",'span[note-event="event"]',function(){var e=this,n=e.getAttribute("note-data").split("|");t.callback("label",n[0],n[1],n[2])})}},"undefined"!=typeof module&&module.exports?module.exports=l:"undefined"!=typeof define&&define.amd?define(function(){return l}):t.RtlNoteCalendar=l}(document,window,jQuery);